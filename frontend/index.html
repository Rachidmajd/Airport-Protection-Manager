<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aeronautical Deconfliction & Analysis Platform</title>
    
    <!-- Third-party CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />
    
    <!-- Application CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<script>
    // QUICK OCR MODAL FIX - Add this to your index.html
    (function() {
        'use strict';
        
        console.log('üîß Quick OCR Modal Fix Loading...');
        
        // 1. Create the modal HTML if it doesn't exist
        function createOCRModal() {
            if (document.getElementById('ocr-processing-modal')) {
                console.log('OCR Modal already exists');
                return;
            }
            
            const modalHTML = `
                <div id="ocr-processing-modal" style="
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                    background: rgba(0, 0, 0, 0.7); display: none; align-items: center;
                    justify-content: center; z-index: 10000; opacity: 0;
                    transition: opacity 0.3s ease; backdrop-filter: blur(5px);
                ">
                    <div class="ocr-modal-content" style="
                        background: white; border-radius: 16px; padding: 40px;
                        text-align: center; max-width: 400px; width: 90%;
                        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                        transform: scale(0.8); transition: transform 0.3s ease;
                    ">
                        <div id="ocr-content"></div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            console.log('‚úÖ OCR Modal created');
        }
        
        // 2. Simple OCR Modal Manager
        window.QuickOCRModal = {
            modal: null, content: null,
            
            init() {
                createOCRModal();
                this.modal = document.getElementById('ocr-processing-modal');
                this.content = document.getElementById('ocr-content');
                
                this.modal.addEventListener('click', (e) => {
                    if (e.target === this.modal) this.hide();
                });
            },
            
            show() {
                this.modal.style.display = 'flex';
                this.modal.style.opacity = '1';
                this.modal.querySelector('.ocr-modal-content').style.transform = 'scale(1)';
            },
            
            hide() {
                this.modal.style.opacity = '0';
                this.modal.querySelector('.ocr-modal-content').style.transform = 'scale(0.8)';
                setTimeout(() => this.modal.style.display = 'none', 300);
            },
            
            showProcessing(message = 'Processing image with OCR...') {
                this.content.innerHTML = `
                    <div style="width: 80px; height: 80px; margin: 0 auto 20px; position: relative; border: 3px solid #e3f2fd; border-radius: 12px;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, transparent, #2196f3, transparent); animation: scan 2s linear infinite;"></div>
                    </div>
                    <div style="font-size: 18px; font-weight: 600; color: #333; margin-bottom: 10px;">${message}</div>
                    <div style="font-size: 14px; color: #666; margin-bottom: 20px;">Analyzing text regions...</div>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <span>Processing</span>
                        <div style="display: flex; gap: 4px;">
                            <div style="width: 8px; height: 8px; background: #2196f3; border-radius: 50%; animation: wave 1.4s linear infinite;"></div>
                            <div style="width: 8px; height: 8px; background: #2196f3; border-radius: 50%; animation: wave 1.4s linear infinite; animation-delay: 0.2s;"></div>
                            <div style="width: 8px; height: 8px; background: #2196f3; border-radius: 50%; animation: wave 1.4s linear infinite; animation-delay: 0.4s;"></div>
                        </div>
                    </div>
                `;
                this.show();
            },
            
            showSuccess(message = 'OCR completed!', details = '') {
                this.content.innerHTML = `
                    <div style="width: 80px; height: 80px; margin: 0 auto 20px; position: relative;">
                        <div style="width: 80px; height: 80px; border: 3px solid #4caf50; border-radius: 50%; animation: checkmark-circle 0.6s ease-in-out;">
                            <div style="position: absolute; top: 50%; left: 50%; width: 30px; height: 15px; border: 3px solid #4caf50; border-top: none; border-right: none; transform: translate(-50%, -60%) rotate(-45deg) scale(0); animation: checkmark-line 0.3s ease-in-out 0.6s both;"></div>
                        </div>
                    </div>
                    <div style="font-size: 18px; font-weight: 600; color: #333; margin-bottom: 10px;">${message}</div>
                    <div style="padding: 15px; margin-top: 20px; border: 1px solid #c3e6cb; border-radius: 8px; background-color: #d4edda; color: #155724; font-size: 14px;">
                        <strong>Success!</strong> Text recognition completed. ${details}
                    </div>
                    <button onclick="window.QuickOCRModal.hide()" style="background: #2196f3; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 14px; cursor: pointer; margin-top: 20px;">Continue</button>
                `;
            },
            
            showError(message = 'OCR failed', error = '') {
                this.content.innerHTML = `
                    <div style="width: 80px; height: 80px; margin: 0 auto 20px; position: relative;">
                        <div style="width: 80px; height: 80px; border: 3px solid #f44336; border-radius: 50%; animation: error-shake 0.5s ease-in-out;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                                <div style="position: absolute; width: 30px; height: 3px; background: #f44336; transform: rotate(45deg);"></div>
                                <div style="position: absolute; width: 30px; height: 3px; background: #f44336; transform: rotate(-45deg);"></div>
                            </div>
                        </div>
                    </div>
                    <div style="font-size: 18px; font-weight: 600; color: #333; margin-bottom: 10px;">${message}</div>
                    <div style="padding: 15px; margin-top: 20px; border: 1px solid #f5c6cb; border-radius: 8px; background-color: #f8d7da; color: #721c24; font-size: 14px;">
                        <strong>Error!</strong> ${error || 'Please try again.'}
                    </div>
                    <button onclick="window.QuickOCRModal.hide()" style="background: #2196f3; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 14px; cursor: pointer; margin-top: 20px;">Try Again</button>
                `;
            }
        };
        
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes scan { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(74px); opacity: 0.3; } }
            @keyframes wave { 0%, 60%, 100% { transform: scale(1); opacity: 0.5; } 30% { transform: scale(1.3); opacity: 1; } }
            @keyframes checkmark-circle { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
            @keyframes checkmark-line { 0% { transform: translate(-50%, -60%) rotate(-45deg) scale(0); opacity: 0; } 100% { transform: translate(-50%, -60%) rotate(-45deg) scale(1); opacity: 1; } }
            @keyframes error-shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        `;
        document.head.appendChild(style);
        
        // Hook into existing OCR button
        function hookOCRButton() {
            const ocrButton = document.querySelector('#run-ocr-btn');
            if (!ocrButton) {
                setTimeout(hookOCRButton, 1000);
                return;
            }
            
            console.log('üéØ Found OCR button, adding enhanced modal...');
            
            const originalHandler = ocrButton.onclick;
            ocrButton.onclick = async function(e) {
                console.log('üöÄ Enhanced OCR clicked!');
                window.QuickOCRModal.showProcessing('Starting OCR analysis...');
                
                try {
                    if (originalHandler) await originalHandler.call(this, e);
                    setTimeout(() => {
                        window.QuickOCRModal.showSuccess('OCR completed!', 'Text extracted successfully.');
                    }, 3000);
                } catch (error) {
                    window.QuickOCRModal.showError('OCR failed', error.message);
                }
            };
            console.log('‚úÖ OCR button enhanced');
        }
        
        // Test function
        window.testOCRModal = () => {
            window.QuickOCRModal.showProcessing('Testing...');
            setTimeout(() => window.QuickOCRModal.showSuccess('Test passed!'), 2000);
        };
        
        // Initialize
        function init() {
            window.QuickOCRModal.init();
            hookOCRButton();
            console.log('‚úÖ Quick OCR Modal ready! Test with: window.testOCRModal()');
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    })();
    </script>
    
<body>

    <!-- ===== APPLICATION SCREENS ===== -->

    <!-- Loading Screen -->
    <div id="loading-screen" class="screen loading-screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2>Aeronautical Deconfliction Platform</h2>
            <p>Initializing secure aviation analysis system...</p>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen login-screen hidden">
        <div class="login-container">
            <div class="login-header">
                <h1>üõ©Ô∏è Aviation Platform</h1>
                <p>Secure access required for aeronautical operations</p>
            </div>
            <div class="login-content">
                <form id="login-form" class="login-form" novalidate>
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" required placeholder="Enter your username" autocomplete="username" autocapitalize="none" spellcheck="false">
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" required placeholder="Enter your password" autocomplete="current-password">
                    </div>
                    <div id="login-error" class="login-error hidden" role="alert"></div>
                    <button type="submit" id="login-btn" class="login-button">
                        <span id="login-btn-text">üîê Login</span>
                        <span id="login-spinner" class="login-spinner hidden">‚è≥ Logging in...</span>
                    </button>
                </form>
                <div class="login-footer">
                    <p><strong>Test credentials:</strong> testuser / oper</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application Screen -->
    <div id="app" class="screen app hidden">
        
        <!-- Main Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-brand"><h1 class="header-title">üõ©Ô∏è</h1></div>
                <div class="header-project-area">
                    <div id="project-opener">
                        <button id="open-project-btn" class="button primary">Open Project</button>
                    </div>
                    <div id="project-display" class="hidden">
                        <div class="project-info">
                            <span class="project-label">Project:</span>
                            <span id="project-title-text" class="project-title-text"></span>
                        </div>
                        <div class="project-actions">
                            <div class="dropdown">
                                <button id="operations-dropdown-btn" class="button secondary dropdown-toggle">Operations ‚ñº</button>
                                <div id="operations-dropdown-menu" class="dropdown-menu hidden">
                                    <a href="#" id="edit-project-btn" class="dropdown-item">Edit Project</a>
                                    <a href="#" id="submit-project-btn" class="dropdown-item">Submit Project</a>
                                    <a href="#" id="report-project-btn" class="dropdown-item">Generate Report</a>
                                </div>
                            </div>
                            <button id="close-project-btn" class="button secondary danger">&times; Close</button>
                        </div>
                    </div>
                </div>
                <div class="header-actions">
                    <span id="user-info" class="user-info">Loading...</span>
                    <button id="logout-btn" class="logout-button">Logout</button>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <div class="main-content">
            <aside class="sidebar">
                <div class="panel">
                    <h2 class="panel-title">Flight Procedures</h2>
                    <div id="procedure-controls">
                        <div id="procedure-list" class="procedure-list"></div>
                    </div>
                </div>
                <div class="panel">
                    <h2 class="panel-title">
                        Conflict Summary
                        <span id="conflict-count" class="conflict-count zero">0</span>
                    </h2>
                    <div id="conflict-list" class="conflict-list">
                        <div class="no-conflicts"><p>‚úÖ No conflicts detected</p></div>
                    </div>
                </div>
            </aside>
            <main class="map-container">
                <div id="map" class="map"></div>
                <div class="map-tools-container">
                    <div id="drawing-tools-panel" class="drawing-tools hidden">
                        <h3>Draw Drone Zone</h3>
                        <button id="draw-polygon-btn" class="tool-button"><span>üìê Polygon</span></button>
                        <button id="draw-circle-btn" class="tool-button"><span>‚≠ï Circle</span></button>
                        <button id="draw-point-btn" class="tool-button"><span>üìç Point</span></button> <!-- NEW -->
                        <button id="manual-entry-btn" class="tool-button"><span>‚å®Ô∏è Enter Coordinates</span></button> <!-- NEW -->
                    </div>
                    <div id="import-tools-panel" class="drawing-tools hidden">
                        <h3>Import Data</h3>
                        <button id="import-image-btn" class="tool-button"><span>üñºÔ∏è Import Image</span></button>
                        <button id="import-geometry-btn" class="tool-button"><span>üìÑ Import Geometry</span></button>
                    </div>
                </div>
                <div class="map-status">
                    <div id="map-coords">Lat: 0.00, Lng: 0.00</div>
                </div>
            </main>
        </div>
    </div>

    <!-- ===== MODALS ===== -->
    <div id="modals-container">
        <!-- Project Selection List -->
        <div id="project-list-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="project-list-title">Select a Project</h2>
                    <button id="close-project-modal-btn" class="close-button">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="project-list-actions">
                        <button id="new-project-btn" class="button primary full-width">+ New Project</button>
                    </div>
                    <div id="project-list-container" class="project-list"></div>
                </div>
            </div>
        </div>

        <div id="point-radius-group" class="form-group hidden">
            <label for="point-radius">Operation Radius (meters) *</label>
            <input type="number" id="point-radius" name="pointRadius" value="100" min="10" max="1000">
            <small class="form-help">Defines the circular operation area around the point</small>
        </div>

        <!-- Project Editor Form -->
        <div id="project-editor-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="project-editor-title">Create New Project</h2>
                    <button id="close-project-editor-btn" class="close-button">&times;</button>
                </div>
                <form id="project-editor-form" class="modal-body">
                    <input type="hidden" id="project-id" name="id">
                    <div class="form-group">
                        <label for="project-title">Project Title *</label>
                        <input type="text" id="project-title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="project-description">Description</label>
                        <textarea id="project-description" name="description" rows="3"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-start-date">Start Date *</label>
                            <input type="datetime-local" id="project-start-date" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="project-end-date">End Date *</label>
                            <input type="datetime-local" id="project-end-date" name="endDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-altitude-min">Min Altitude (ft AGL)</label>
                            <input type="number" id="project-altitude-min" name="altitudeMin" value="0">
                        </div>
                        <div class="form-group">
                            <label for="project-altitude-max">Max Altitude (ft AGL)</label>
                            <input type="number" id="project-altitude-max" name="altitudeMax" value="400">
                        </div>
                    </div>
                    <div class="form-row">
                         <div class="form-group">
                            <label for="project-priority">Priority</label>
                            <select id="project-priority" name="priority">
                                <option value="Low">Low</option>
                                <option value="Normal" selected>Normal</option>
                                <option value="High">High</option>
                                <option value="Critical">Critical</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="project-operation-type">Operation Type</label>
                            <input type="text" id="project-operation-type" name="operationType">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancel-project-editor-btn" class="button secondary">Cancel</button>
                        <button type="submit" class="button primary">Save Project</button>
                    </div>
                </form>
            </div>
        </div>


        <!-- Add this to the modals-container section -->
        <div id="coordinate-entry-modal" class="modal hidden">
            <div class="modal-content wide">
                <div class="modal-header">
                    <h2>Enter Coordinates Manually</h2>
                    <button id="close-coordinate-modal" class="close-button">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="coordinate-entry-form">
                        <div class="form-group">
                            <label for="zone-name">Zone Name *</label>
                            <input type="text" id="zone-name" name="zoneName" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="geometry-type-selector">Geometry Type</label>
                                <select id="geometry-type-selector" name="geometryType">
                                    <option value="polygon">Polygon</option>
                                    <option value="circle">Circle</option>
                                    <option value="point">Point</option>
                                    <option value="multipoint">Multiple Points</option>
                                </select>
                                <small class="form-help">Select the type of geometry to create</small>
                            </div>
                            <div class="form-group">
                                <label for="coordinate-format">Coordinate Format</label>
                                <select id="coordinate-format" name="format">
                                    <option value="decimal">Decimal Degrees (DD)</option>
                                    <option value="dms">Degrees Minutes Seconds (DMS)</option>
                                    <option value="geojson">GeoJSON Array</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="coordinate-system">Coordinate System</label>
                                <select id="coordinate-system" name="system">
                                    <option value="wgs84">WGS84 (GPS Standard)</option>
                                    <option value="utm">UTM (Future Support)</option>
                                </select>
                            </div>
                            <div class="form-group circle-only hidden">
                                <label for="circle-points">Circle Precision</label>
                                <select id="circle-points" name="circlePoints">
                                    <option value="32">Low (32 points)</option>
                                    <option value="64" selected>Medium (64 points)</option>
                                    <option value="128">High (128 points)</option>
                                </select>
                                <small class="form-help">More points = smoother circle but larger file size</small>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="coordinates-input">
                                Coordinates *
                                <small>Format varies by geometry type selected above</small>
                            </label>
                            <textarea id="coordinates-input" name="coordinates" rows="10" 
                                      placeholder="Select geometry type and format above to see example..." 
                                      required></textarea>
                        </div>
        
                        <!-- Circle-specific information panel -->
                        <div id="circle-info-panel" class="form-group circle-only hidden" style="
                            background: #f0f9ff; 
                            border: 1px solid #0ea5e9; 
                            border-radius: 6px; 
                            padding: 15px;
                            margin: 15px 0;
                        ">
                            <h4 style="color: #0369a1; margin-bottom: 8px;">üìè Circle Input Format</h4>
                            <div style="font-size: 13px; color: #374151;">
                                <p><strong>Decimal:</strong> longitude, latitude, radius_meters</p>
                                <p><strong>DMS:</strong> deg¬∞min'sec"N/S deg¬∞min'sec"E/W radius_meters</p>
                                <p><strong>GeoJSON:</strong> [longitude, latitude, radius_meters]</p>
                                <hr style="margin: 10px 0; border: none; border-top: 1px solid #cbd5e1;">
                                <p style="margin: 0;"><strong>Radius limits:</strong> 1m to 50,000m (50km)</p>
                            </div>
                        </div>
        
                        <!-- Point-specific options -->
                        <div id="point-options-group" class="form-group hidden">
                            <label for="point-operation-radius">Operation Radius (meters) *</label>
                            <input type="number" id="point-operation-radius" name="pointRadius" value="100" min="10" max="1000">
                            <small class="form-help">Defines the circular operation area around each point</small>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="coord-altitude-min">Min Altitude (ft AGL) *</label>
                                <input type="number" id="coord-altitude-min" name="altitudeMin" value="0" min="0" max="400" required>
                            </div>
                            <div class="form-group">
                                <label for="coord-altitude-max">Max Altitude (ft AGL) *</label>
                                <input type="number" id="coord-altitude-max" name="altitudeMax" value="400" min="0" max="400" required>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" id="validate-coordinates" class="button secondary">üîç Validate & Preview</button>
                            <button type="button" id="cancel-coordinate-entry" class="button secondary">Cancel</button>
                            <button type="submit" class="button primary" disabled>Create Zone</button>
                        </div>
                    </form>
                    
                    <!-- Preview map -->
                    <div id="coordinate-preview-container" class="hidden">
                        <h3>Preview</h3>
                        <div id="coordinate-preview-map" style="height: 300px; border-radius: 6px; border: 1px solid #d1d5db;"></div>
                    </div>
                </div>
            </div>
        </div>

        
        <div id="drone-form-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Create Drone Zone</h2>
                    <button id="close-modal" class="close-button">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="drone-zone-form">
                        <div class="form-group">
                            <label for="operation-id">Operation ID *</label>
                            <input type="text" id="operation-id" name="operationId" required>
                            <div class="form-error" id="operation-id-error"></div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="altitude-min">Min Altitude (ft AGL) *</label>
                                <input type="number" id="altitude-min" name="altitudeMin" value="0" min="0" max="400" required>
                                <div class="form-error" id="altitude-min-error"></div>
                            </div>
                            <div class="form-group">
                                <label for="altitude-max">Max Altitude (ft AGL) *</label>
                                <input type="number" id="altitude-max" name="altitudeMax" value="400" min="0" max="400" required>
                                <div class="form-error" id="altitude-max-error"></div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="start-time">Start Time *</label>
                                <input type="datetime-local" id="start-time" name="startTime" required>
                                <div class="form-error" id="start-time-error"></div>
                            </div>
                            <div class="form-group">
                                <label for="end-time">End Time *</label>
                                <input type="datetime-local" id="end-time" name="endTime" required>
                                <div class="form-error" id="end-time-error"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status" name="status" required>
                                <option value="Planned">Planned</option>
                                <option value="Active">Active</option>
                                <option value="Completed">Completed</option>
                            </select>
                            <div class="form-error" id="status-error"></div>
                        </div>

                        <div class="form-actions">
                            <button type="button" id="cancel-drone-form" class="button secondary">Cancel</button>
                            <button type="submit" class="button primary">Create Drone Zone</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="report-modal" class="modal hidden">
            <div class="modal-content wide">
                <div class="modal-header">
                    <h2 id="report-title">üñ®Ô∏è Preliminary Analysis Report</h2>
                    <button id="close-report-btn" class="close-button">&times;</button>
                </div>
                <div class="modal-body" id="report-body">
                    </div>
                <div class="modal-footer">
                    <button id="print-report-btn" class="button secondary">üñ®Ô∏è Print</button>
                    <button id="export-pdf-btn" class="button primary">üìÑ Export as PDF</button>
                </div>
            </div>
        </div>

        <div id="ocr-processing-modal" class="modal hidden" style="z-index: 10000; backdrop-filter: blur(5px);">
            <div class="ocr-modal-content">
                <div id="ocr-content">
                    <!-- Dynamic content will be inserted here -->
                </div>
            </div>
        </div>

    </div>
    
    <!-- Notification Container -->
    <div id="notification-container"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@2/dist/tesseract.min.js'></script>
    <script type="module" src="js/main.js"></script>
    <script>
        // Screen manager script remains the same
    </script>
    <script>
        // Screen Manager - Add this directly to your HTML
        window.screenManager = {
            currentScreen: null,
            
            showScreen(screenId) {
                console.log(`üñ•Ô∏è Showing screen: ${screenId}`);
                
                // Hide all screens first
                const screens = ['loading-screen', 'login-screen', 'app'];
                screens.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.classList.add('hidden');
                        element.style.display = 'none';
                        console.log(`üëÅÔ∏è Hidden screen: ${id}`);
                    }
                });
                
                // Show the requested screen
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) {
                    targetScreen.classList.remove('hidden');
                    targetScreen.style.display = 'flex';
                    this.currentScreen = screenId;
                    console.log(`‚úÖ Showing screen: ${screenId}`);
                } else {
                    console.error(`‚ùå Screen not found: ${screenId}`);
                }
            },
            
            hideScreen(screenId) {
                console.log(`üôà Hiding screen: ${screenId}`);
                const element = document.getElementById(screenId);
                if (element) {
                    element.classList.add('hidden');
                    element.style.display = 'none';
                }
            },
            
            getCurrentScreen() {
                return this.currentScreen;
            }
        };
        
        // Initialize with loading screen
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üì∫ Screen manager initialized');
            window.screenManager.showScreen('loading-screen');
        });
        </script>
</body>
</html>
